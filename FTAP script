local plr = game:GetService("Players")
local me  = plr.LocalPlayer
local char = me.Character or me.CharacterAdded:wait()
local hum = char:FindFirstChildOfClass("Humanoid")
local hrp = char:WaitForChild("HumanoidRootPart")

local work = game:GetService("Workspace")
local run = game:GetService("RunService")
local uis = game:GetService("UserInputService")
local rep = game:GetService("ReplicatedStorage")
local textChat = game:GetService("TextChatService")
local guiService = game:GetService("GuiService")
local starterGui = game:GetService("StarterGui")
local light = game:GetService("Lighting")
local tpService = game:GetService("TeleportService")
local virtual = game:GetService("VirtualInputManager")

local mouse = me:GetMouse()
local camera = work.CurrentCamera

local function update()
	char = me.Character
	hum = char:WaitForChild("Humanoid")
	hrp = char:WaitForChild("HumanoidRootPart")
end

me.CharacterAdded:Connect(update)

if me.Character then
	update()
end

local screen  = Instance.new("ScreenGui")
screen.Parent = me.PlayerGui
screen.Name   = "Gui"
screen.ResetOnSpawn = false
screen.IgnoreGuiInset = true

local frame    = Instance.new("Frame")
frame.Parent   = screen
frame.Size     = UDim2.new(0,250,0,280)
frame.Position = UDim2.new(0,15,0,380)
frame.Active     = true

local scroll = Instance.new("ScrollingFrame")
scroll.Parent   = frame
scroll.Size     = UDim2.new(0,145,0,125)
scroll.Position = UDim2.new(0.225,0,0.2,0)
scroll.BackgroundTransparency = 0
scroll.ScrollBarThickness = 5
scroll.AutomaticCanvasSize = Enum.AutomaticSize.XY
scroll.ScrollingDirection = Enum.ScrollingDirection.XY
scroll.Active = true

local layout = Instance.new("UIListLayout")
layout.Parent = scroll
layout.Padding = UDim.new(0,5)
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.VerticalAlignment = Enum.VerticalAlignment.Top
layout.HorizontalAlignment = Enum.HorizontalAlignment.Left

local btn    = Instance.new("TextButton")
btn.Parent   = frame
btn.Size     = UDim2.new(0,25,0,25)
btn.Position = UDim2.new(0,225,0,0)
btn.Text     = "X"
btn.TextSize = 12

local text             = Instance.new("TextBox")
text.Parent            = frame
text.Size              = UDim2.new(0,80,0,35)
text.Position          = UDim2.new(0,90,0,190)
text.Text              = ""
text.PlaceholderText   = "Command"
text.PlaceholderColor3 = Color3.fromRGB(70,70,70)
text.TextSize          = 12

local btn2    = Instance.new("TextButton")
btn2.Parent   = frame
btn2.Size     = UDim2.new(0,80,0,35)
btn2.Position = UDim2.new(0,30,0,230)
btn2.Text     = "Makes"
btn2.TextSize = 12

local btn3    = Instance.new("TextButton")
btn3.Parent   = frame
btn3.Size     = UDim2.new(0,80,0,35)
btn3.Position = UDim2.new(0,150,0,230)
btn3.Text     = "Stp"
btn3.TextSize = 12

local label             = Instance.new("TextLabel")
label.Parent            = frame
label.Size              = UDim2.new(0,100,0,15)
label.Position          = UDim2.new(0,80,0,20)
label.BorderSizePixel = 0
label.Text              = "Fling things and people\ncmds:"
label.TextSize          = 14

function notify(title, text, duration)
	starterGui:SetCore("SendNotification",{
		Title = title,
		Text = text,
		Duration = duration,
	})
end

function addCmd(name)
	local label             = Instance.new("TextLabel")
	label.Parent            = scroll
	label.Size              = UDim2.new(0,100,0,15)
	label.AutomaticSize     = Enum.AutomaticSize.XY
	label.BorderSizePixel = 0
	label.Text              = tostring(name)
	label.TextSize          = 14
end

local dragging = false
local dragStart
local startPos

frame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = frame.Position

		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

uis.InputChanged:Connect(function(input)
	if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
		local delta = input.Position - dragStart
		frame.Position = startPos + UDim2.new(0,delta.X,0,delta.Y)
	end
end)

btn.MouseButton1Click:Connect(function()
	screen:Destroy()
end)

local cmds = {
	" |       fling       | ",
	" |       bring       | ",
	" |   teleport ; tp   | ",
	" | freeze / unfreeze | ",
	" | hook / moveToHook | "
}

for i = 1,#cmds do
	addCmd(cmds[i])
end

local bools = {
	fling = false,
	bring = false,
	teleport = false,
	freeze = false,
	hook = false,
	
	hookCon = nil,
	hookToggle = false
}

btn2.MouseButton1Click:Connect(function()
	local value = nil
	if text.Text ~= "" then
		value = text.Text:lower()
	end
	if not value then return end

	if value == ("freeze"):lower() or value == ("unfreeze"):lower() then
		bools.freeze = true
		notify("Command: freeze","Press Z to toggle object freeze while holding.",7)
	elseif value == ("teleport"):lower() or value == ("tp"):lower() then
		bools.teleport = true
		notify("Command: teleport","Press C to teleport object far away while holding.",7)
	elseif value == ("fling"):lower() then
		bools.fling = true
		notify("Command: fling","Press Q to fling object far away while holding.",7)
	elseif value == ("bring") then
		bools.bring = true
		notify("Command: bring","Press X to bring object to you while holding.",7)
	elseif value == ("hook") or value == ("movetohook"):lower() then
		bools.hook = true
		notify("Command: hook","Press V to toggle move to hook.",7)
	end
end)

btn3.MouseButton1Click:Connect(function()
	local value = nil
	if text.Text ~= "" then
		value = text.Text:lower()
	end
	if not value then return end

	if value == ("freeze"):lower() or value == ("unfreeze"):lower() then
		bools.freeze = false
		notify("Stopped command:","freeze / unfreeze",7)
	elseif value == ("teleport"):lower() or value == ("tp"):lower() then
		bools.teleport = false
		notify("Stopped command:","teleport",7)
	elseif value == ("fling"):lower() then
		bools.fling = false
		notify("Stopped command:","fling",7)
	elseif value == ("bring") then
		bools.bring = false
		notify("Stopped command:","bring",7)
	elseif value == ("hook") or value == ("movetohook"):lower() then
		bools.hook = false
		notify("Stopped command:","hook",7)
	end
end)

uis.InputBegan:Connect(function(i,g)
	if g then return end

	if i.KeyCode == Enum.KeyCode.Q then
		if bools.fling then
			if work:FindFirstChild("GrabParts") then
				work.GrabParts.GrabPart.Velocity = camera.CFrame.LookVector * 1500
				work.GrabParts:Destroy()

				virtual:SendMouseButtonEvent(1, 1, 0, true, nil, 0)

				virtual:SendMouseButtonEvent(1, 1, 0, false, nil, 0)
			end
		end
	elseif i.KeyCode == Enum.KeyCode.Z then
		if bools.freeze then
			if work:FindFirstChild("GrabParts") then
				if work.GrabParts.GrabPart.Anchored == false then
					work.GrabParts.GrabPart.Anchored = true
				else
					work.GrabParts.GrabPart.Anchored = false
				end
			end
		end
	elseif i.KeyCode == Enum.KeyCode.X then
		if bools.bring then
			if work:FindFirstChild("GrabParts") then
				work.GrabParts.GrabPart.CFrame = hrp.CFrame
			end
		end
	elseif i.KeyCode == Enum.KeyCode.C then
		if bools.teleport then
			if work:FindFirstChild("GrabParts") then
				work.GrabParts.GrabPart.CFrame = CFrame.new(hrp.CFrame.LookVector * 600 + Vector3.new(0,100,0))
			end
		end
	elseif i.KeyCode == Enum.KeyCode.V then
		if bools.hook then
			if bools.hookCon then
				bools.hookCon:Disconnect()
				bools.hookCon = nil
			end
			if not bools.hookToggle then
				bools.hookToggle = true

				bools.hookCon = run.Heartbeat:Connect(function()
					if work:FindFirstChild("GrabParts") then
						hrp.CFrame = CFrame.new(hrp.Position + (work.GrabParts.BeamPart.Position - hrp.Position).Unit * 30 * run.Heartbeat:Wait())
					end
				end)
			else
				bools.hookToggle = false

				if bools.hookCon then
					bools.hookCon:Disconnect()
					bools.hookCon = nil
				end
			end
		end
	end
end)

if not game:GetService("CoreGui") then return end

local suc, err = pcall(function()
	screen.Parent = game:GetService("CoreGui")
end)

if not suc then
	print("Cannot set gui parent to 'CoreGui' ( We tried ).")
end
